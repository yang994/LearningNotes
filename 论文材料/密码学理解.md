# 密码学 

密码学，主要服务与信息的通信。主要解决信息通信过程中的几个关键问题。  
1.如何防止信息被他人窃听(加密算法)  
2.如何保证信息未被篡改(签名算法)  

## 相关术语
  
  + 信息明文 `m` 密文`M`
  + 签名 `r`
  + 秘钥 `P`
  + 公钥 `Pk`
  + 私钥 `Sk`

## 加密算法

为了防止信息被他人窃听，在传输之前，用算法将`明文`加密成`密文`，只有专用的`秘钥`才能从`密文`恢复成`明文`。  

+ 对称加密
  + 信息双方持有秘钥`P`
  + 加密过程 M=f(m,P) 发送M 解密过程 m=g(M,P)
  + 用同样的秘钥做加解密操作，效率高，但是双方在约定相同秘钥的时候有可能泄露信息

+ 非对称加密
  + 信息发送者持有公钥`Pk`，信息接受者持有私钥`Sk`
  + 加密过程 M=f(m,Pk)，加密者发送M 解密过程 m=(M,Sk)
  + 公钥`Pk`为公开信息，只用于加密，无法解密。私钥`Sk`只有信息持有者拥有，用来解密，相对于对称加密，更加安全，效率较低

## 签名算法

用于防止信息传输过程中被他人篡改，信息发送者用自己的私钥`Sk`进行加密，发送（m，r，Pk），使用公钥可以验证信息是否遭到篡改

+ r=f(m,Sk) 私钥签名
+ 发送(m,Pk,r) 发送数据，公钥，签名。不发送私钥
+ g(m,Pk,r)==0? 验证，满足算法要求则证明数据真实

### 签名的聚合

  + 存在多个数据私钥对(m1,Pk1)...(mi,Pki)有(m1,r1,Sk1)...(mi,ri,Ski)
  + 验证所有`f(ri,mi,Pki)==0`可以等价为验证`f(x(r1,..ri),y(m1,..mi),z(Pk1,..Pki))==0` 则这种签名方法可以聚合
  + x(),y(),z()为信息聚合的方法，通常为叠加。签名的聚合可以降低运算开销，对于验证方来说，也无法判断收到的信息是一条信息的签名还是多条信息的聚合签名，因为形式上是一样的

### ECDSA签名

+ 椭圆曲线基点`G`，随机数`k` 公钥`Pk`=Sk·G
+ 签名r=(k·G)横坐标，s=(hash(m)+r· Sk)/k
+ 发送(m,r,s,Pk)
+ 验证 {(hash(m)/s)·G+(r/s)·Pk}的横坐标 == r
+ ECDSA签名算法无法做聚合，只能逐条验证

### Schnorr签名
+ 椭圆曲线基点`G`，随机数`k` 公钥`Pk`=Sk·G
+ 签名r=hash(Pk,k·G,m)·Sk+k
+ 发送信息(hash(Pk,k·G,m),r,Pk,k·G)
+ 验证r·G==hash(Pk,k·G,m)·Pk+k·G
+ 签名的聚合
  + 多条信息 (m1,r1,Pk1,k1)...(mi,ri,Pki,ki)有ri·G==hash(Pki,ki·G,mi)·Pki+ki·G
  + `R`=∑ri  `K`=∑ki
  + R·G=(∑hash(Pki,ki·G,mi)·Pki)+K·G

### BLS签名
+ 哈希到曲线：h(m)=P(x,y) 将信息通过某种算法转换为椭圆曲线上的点
+ 曲线配对: e(P,Q)=n 一种`特殊的函数`，传入椭圆曲线上的两个点，输出一个数
  + 函数性质：e(aP,bQ)=e(abP,Q)=e(P,abQ)=e(P,Q)^(ab)  （a b 为数）
  + e(P,Q+R)=e(P,Q)e(P,R)
+ 签名r=Sk·h(m)
+ 验证e(Pk,h(m))==e(G,r)
+ 推导：e(Pk,h(m))=e(Sk·G,h(m))=e(G,Sk·h(m))=e(G,r)
+ 签名聚合
  + `R`=∑ri `P`=∑Pki
  + πe(Pki,h(mi))=e(G,R),当mi相等时，e(P,h(m))=e(G,R)

